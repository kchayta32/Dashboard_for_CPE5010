<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPE5010 - ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="course-info">
                    <h1 class="course-title">üìö CPE5010 (001) 47/4734</h1>
                    <h2 class="course-name">‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Å‡∏°</h2>
                    <p class="instructor">‡∏ú‡∏®.‡∏î‡∏£. ‡∏£‡∏ß‡∏¥ ‡∏≠‡∏∏‡∏ï‡∏ï‡∏°‡∏ò‡∏ô‡∏¥‡∏ô‡∏ó‡∏£‡πå</p>
                    <div class="firebase-status" id="firebaseStatus">
                        <span class="status-dot connecting"></span>
                        <span class="status-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase...</span>
                        <button class="refresh-btn" onclick="refreshFromFirebase()" title="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">üîÑ</button>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="saveData()">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                    <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle" onclick="toggleDropdown()">
                            üì• Export ‚ñº
                        </button>
                        <div class="dropdown-menu" id="exportDropdown">
                            <button class="dropdown-item" onclick="exportJSON()">üìÑ Export JSON</button>
                            <button class="dropdown-item" onclick="exportCSV()">üìä Export CSV</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Stats Overview -->
        <section class="stats-section">
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-info">
                    <span class="stat-value" id="totalGroups">14</span>
                    <span class="stat-label">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-info">
                    <span class="stat-value" id="submittedCount">0</span>
                    <span class="stat-label">‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚è≥</div>
                <div class="stat-info">
                    <span class="stat-value" id="pendingCount">0</span>
                    <span class="stat-label">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìä</div>
                <div class="stat-info">
                    <span class="stat-value" id="gradedCount">0</span>
                    <span class="stat-label">‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
                </div>
            </div>
        </section>

        <!-- Assignment Tabs -->
        <section class="assignment-section">
            <div class="assignment-header">
                <h3>üìã ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á</h3>
                <div class="assignment-tabs" id="assignmentTabs">
                    <!-- Tabs will be generated by JS -->
                </div>
            </div>

            <div class="current-assignment" id="currentAssignment">
                <!-- Current assignment info -->
            </div>
        </section>

        <!-- Groups Table -->
        <section class="groups-section">
            <div class="table-header">
                <h3>üë• ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</h3>
                <div class="table-actions">
                    <button class="btn btn-sm" onclick="markAllSubmitted()">‚úÖ ‡∏™‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                    <button class="btn btn-sm btn-outline" onclick="clearAllSubmissions()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                </div>
            </div>

            <div class="table-container">
                <table class="groups-table">
                    <thead>
                        <tr>
                            <th class="col-group">‡∏Å‡∏•‡∏∏‡πà‡∏°</th>
                            <th class="col-members">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</th>
                            <th class="col-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th class="col-date">‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</th>
                            <th class="col-score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                            <th class="col-actions">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="groupsTableBody">
                        <!-- Table rows will be generated by JS -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Leaderboard Section -->
        <section class="leaderboard-section" id="leaderboardSection">
            <div class="leaderboard-header">
                <h3>üèÜ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°</h3>
                <div class="leaderboard-controls">
                    <button class="btn btn-sm view-toggle active" id="btnTableView" onclick="toggleView('table')">
                        üìã ‡∏ï‡∏≤‡∏£‡∏≤‡∏á
                    </button>
                    <button class="btn btn-sm view-toggle" id="btnLeaderboardView" onclick="toggleView('leaderboard')">
                        üèÜ ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö
                    </button>
                </div>
            </div>

            <!-- Leaderboard View -->
            <div class="leaderboard-view" id="leaderboardView" style="display: none;">
                <!-- Confetti Container -->
                <div class="confetti-container" id="confettiContainer"></div>

                <!-- Podium for Top 3 -->
                <div class="podium-container">
                    <div class="podium-item second" id="podium2">
                        <div class="podium-avatar">ü•à</div>
                        <div class="podium-rank">2</div>
                        <div class="podium-name">-</div>
                        <div class="podium-score">-</div>
                        <div class="podium-grade">-</div>
                        <div class="podium-stand second-stand"></div>
                    </div>
                    <div class="podium-item first" id="podium1">
                        <div class="podium-avatar">ü•á</div>
                        <div class="podium-rank">1</div>
                        <div class="podium-name">-</div>
                        <div class="podium-score">-</div>
                        <div class="podium-grade">-</div>
                        <div class="podium-stand first-stand"></div>
                    </div>
                    <div class="podium-item third" id="podium3">
                        <div class="podium-avatar">ü•â</div>
                        <div class="podium-rank">3</div>
                        <div class="podium-name">-</div>
                        <div class="podium-score">-</div>
                        <div class="podium-grade">-</div>
                        <div class="podium-stand third-stand"></div>
                    </div>
                </div>

                <!-- Ranking List -->
                <div class="ranking-list" id="rankingList">
                    <!-- Rankings will be generated by JS -->
                </div>
            </div>
        </section>

        <!-- Add Assignment Modal -->
        <div class="modal" id="assignmentModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</h3>
                    <button class="close-btn" onclick="closeModal('assignmentModal')">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô</label>
                        <input type="text" id="newAssignmentName" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô">
                    </div>
                    <div class="form-group">
                        <label>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°</label>
                        <input type="number" id="newAssignmentMaxScore" value="100" min="1">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('assignmentModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button class="btn btn-primary" onclick="addAssignment()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</button>
                </div>
            </div>
        </div>

        <!-- Edit Assignment Modal -->
        <div class="modal" id="editAssignmentModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡∏≤‡∏ô</h3>
                    <button class="close-btn" onclick="closeModal('editAssignmentModal')">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô</label>
                        <input type="text" id="editAssignmentName" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô">
                    </div>
                    <div class="form-group">
                        <label>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°</label>
                        <input type="number" id="editAssignmentMaxScore" value="100" min="1">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('editAssignmentModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button class="btn btn-primary" onclick="saveEditAssignment()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
            </div>
        </div>

        <!-- Submit Modal -->
        <div class="modal" id="submitModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üì§ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</h3>
                    <button class="close-btn" onclick="closeModal('submitModal')">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="submitModalInfo"></p>
                    <div class="form-group">
                        <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</label>
                        <input type="date" id="submitDate">
                    </div>
                    <div class="form-group">
                        <label>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</label>
                        <input type="time" id="submitTime">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('submitModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button class="btn btn-primary" onclick="confirmSubmit()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
            </div>
        </div>

        <!-- Edit Date Modal -->
        <div class="modal" id="editDateModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</h3>
                    <button class="close-btn" onclick="closeModal('editDateModal')">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="editModalInfo"></p>
                    <p id="currentSubmitDate" class="current-date-info"></p>
                    <div class="form-group">
                        <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà</label>
                        <input type="date" id="editDate">
                    </div>
                    <div class="form-group">
                        <label>‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà</label>
                        <input type="time" id="editTime">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('editDateModal')">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button class="btn btn-primary" onclick="confirmEditDate()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span class="toast-message"></span>
    </div>

    <script src="app.js"></script>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB0msL_J9X9NXMyIrUdQY_59gedMfvpoEE",
            authDomain: "dashboardforstudent.firebaseapp.com",
            projectId: "dashboardforstudent",
            storageBucket: "dashboardforstudent.firebasestorage.app",
            messagingSenderId: "542979977304",
            appId: "1:542979977304:web:59948bec8d82c29b861a2d",
            measurementId: "G-SK4M4DFXC3"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Make Firebase available globally
        window.firebaseDB = db;
        window.firebaseDoc = doc;
        window.firebaseGetDoc = getDoc;
        window.firebaseSetDoc = setDoc;
        window.firebaseOnSnapshot = onSnapshot;

        // Signal that Firebase is ready
        window.dispatchEvent(new Event('firebase-ready'));
        console.log('üî• Firebase initialized successfully');
    </script>
</body>

</html>